% plot the entrainment as a function of time for all the stratifications


base = '/home/ddeepwel/scratch/bsuther/part_settling/2particles/sigma1/Re0.25/';

gamm_dirs = {
'gamm0.1',...
'gamm0.3',...
'gamm0.5',...
'gamm0.7',...
'gamm0.9',...
'gamm1.0'
};
gs = [0.1:0.2:0.9, 1.0];

g01 = {
'1prt_dx25',...
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45_dx25',...
's2_th67.5',...
's2_th90',...
};

g03 = {
'1prt_dx25',...
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45_dx25',...
's2_th67.5_dx25',...
's2_th90_dx25',...
};

g05 = {
'1prt_dx25',...
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45',... % 's2_th45_dx25'
's2_th67.5',...
's2_th90_tall',...
};

g07 = {
'1prt_dx25',...
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45_dx25',...
's2_th67.5',...
's2_th90',...
};

g09 = {
'1prt_dx25',...
's2_th0_dx30',...
's2_th22.5_dx25',...
's2_th45_dx25',...
's2_th67.5_dx25',...
's2_th90_dx25',...
};

g10 = {
'1prt_dx25',...
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45_dx25',...
...
's2_th90_dx25',...
};

gg = {g01, g03, g05, g07, g09, g10};

labs = {'1 particle',...
    '$\theta=0$',...
    '$\theta=22.5$',...
    '$\theta=45$',...
    '$\theta=67.5$',...
    '$\theta=90$',...
    };

figure(108)
clf

cols = default_line_colours();
cols = [0 0 0; cols];

for mm = 1:length(gamm_dirs)
    subplot(2,3,mm)
    hold on
    for nn = 1:length(gg{mm})
        cd([base,gamm_dirs{mm},'/',gg{mm}{nn}])
        try
            entr = load('entrained_tracer');
            if nn == 1
                plot(entr.time, entr.volume*2 * 6/pi,'Color',cols(nn,:));
            else
                plot(entr.time, entr.volume * 6/pi,'Color',cols(nn,:));
            end
        catch
            entr = load('entrained_mass');
            if nn == 1
                plot(entr.time, entr.M_entrain*2 * 6/pi,'Color',cols(nn,:));
            else
                plot(entr.time, entr.M_entrain * 6/pi,'Color',cols(nn,:));
            end
        end
    end
    if mm == 1 || mm == 4
        ylabel('$C_\mathrm{entrain}/V_p$','interpreter','latex')
    end
    if mm == 5
        legend(labs)
    end
    if mm > 3
        xlabel('$t/\tau$')
    end
    title(sprintf('$\\Gamma = %0.2g$',1-gs(mm)))
end

figure_defaults();
cd('../../');
print_figure('entrain_multi_gamma','format','pdf','size',[10 5])
