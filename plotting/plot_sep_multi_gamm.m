% plot the entrainment as a function of time for all the stratifications


base = '/home/ddeepwel/scratch/bsuther/part_settling/2particles/sigma1/Re0.25/';

gamm_dirs = {
'gamm0.1',...
'gamm0.3',...
'gamm0.5',...
'gamm0.7',...
'gamm0.9',...
'gamm1.0'
};
gs = [0.1:0.2:0.9, 1.0];

g01 = {
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45_dx25',...
's2_th67.5',...
's2_th90',...
};

g03 = {
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45_dx25',...
's2_th67.5_dx25',...
's2_th90_dx25',...
};

g05 = {
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45',... % 's2_th45_dx25'
's2_th67.5',...
's2_th90_tall',...
};

g07 = {
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45_dx25',...
's2_th67.5',...
's2_th90',...
};

g09 = {
's2_th0_dx30',...
's2_th22.5_dx25',...
's2_th45_dx25',...
's2_th67.5_dx25',...
's2_th90_dx25',...
};

g10 = {
's2_th0_dx25',...
's2_th22.5_dx25',...
's2_th45_dx25',...
...
's2_th90_dx25',...
};

gg = {g01, g03, g05, g07, g09, g10};

labs = {
    '$\theta=0$',...
    '$\theta=22.5$',...
    '$\theta=45$',...
    '$\theta=67.5$',...
    '$\theta=90$',...
    };

figure(109)
clf

cols = default_line_colours();

for mm = 1:length(gamm_dirs)
    subplot(2,3,mm)
    hold on
    for nn = 1:length(gg{mm})
        cd([base,gamm_dirs{mm},'/',gg{mm}{nn}])
        [t,s,us] = particle_separation();
        plot(t, s, 'Color', cols(nn,:));
        if nn == 1
            max_us(mm) = max(us(:));
        end
    end
    if mm == 1 || mm == 4
        ylabel('$s/D_p$','interpreter','latex')
    end
    if mm == 5
        legend(labs)
    end
    if mm > 3
        xlabel('$t/\tau$')
    end
    title(sprintf('$\\Gamma = %0.2g$',1-gs(mm)))
end

figure_defaults();
cd('../../');
print_figure('sep_multi_gamma','format','pdf','size',[10 5])
